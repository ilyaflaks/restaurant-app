{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\n\n/* /pages/login.js */\nimport React, { useState, useEffect, useContext } from \"react\";\nimport { useRouter } from \"next/router\";\nimport { Container, Row, Col, Button, Form, FormGroup, Label, Input } from \"reactstrap\";\nimport { login } from \"../components/auth\";\nimport AppContext from \"../components/context\";\nimport { signInWithEmailAndPassword, onAuthStateChanged, signOut } from \"firebase/auth\";\nimport { auth } from \"../components/firebase-config\";\n\nfunction Login(props) {\n  var _useState = useState({\n    identifier: \"\",\n    password: \"\"\n  }),\n      data = _useState[0],\n      updateData = _useState[1];\n\n  var _useState2 = useState(false),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  var _useState3 = useState(false),\n      error = _useState3[0],\n      setError = _useState3[1];\n\n  var router = useRouter();\n  var appContext = useContext(AppContext);\n\n  var _useState4 = useState(\"\"),\n      loginEmail = _useState4[0],\n      setLoginEmail = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      loginPassword = _useState5[0],\n      setLoginPassword = _useState5[1];\n\n  var _useState6 = useState(\"\"),\n      errorMsg = _useState6[0],\n      setErrorMsg = _useState6[1];\n\n  var _useState7 = useState(\"false\"),\n      success = _useState7[0],\n      setSuccess = _useState7[1];\n\n  var _useState8 = useState(true),\n      showForm = _useState8[0],\n      setShowForm = _useState8[1]; // useEffect(() => {\n  //   if (appContext.isAuthenticated) {\n  //     router.push(\"/\"); // redirect if you're already logged in\n  //   }\n  // }, []);\n\n\n  var user = appContext.user,\n      setUser = appContext.setUser,\n      isAuthenticated = appContext.isAuthenticated;\n  onAuthStateChanged(auth, function (currentUser) {\n    console.log(\"currentUser:\");\n    console.log(currentUser);\n    console.log(\"something changed in Auth State\"); // appContext.isAuthenticated = true;\n    // appContext.user = true;\n    //    appContext.currentUser = currentUser;\n\n    setUser(currentUser);\n  });\n\n  var authenticate = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _user;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return signInWithEmailAndPassword(auth, loginEmail, loginPassword);\n\n            case 3:\n              _user = _context.sent;\n              console.log(\"inside try block, things are good\");\n              console.log(_user);\n              setErrorMsg(\"\");\n              setShowForm(false);\n              _context.next = 15;\n              break;\n\n            case 10:\n              _context.prev = 10;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(\"inside catch block, things are bad\");\n              console.log(_context.t0.message);\n              setErrorMsg(_context.t0.message);\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 10]]);\n    }));\n\n    return function authenticate() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var logout = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              console.log(\"logout function called\");\n              _context2.next = 3;\n              return signOut(auth);\n\n            case 3:\n              setShowForm(true);\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function logout() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(Container, null, __jsx(Row, null, __jsx(Col, {\n    sm: \"12\",\n    md: {\n      size: 5,\n      offset: 3\n    }\n  }, __jsx(\"div\", {\n    className: \"jsx-1470127334\" + \" \" + \"paper\"\n  }, __jsx(\"div\", {\n    className: \"jsx-1470127334\" + \" \" + \"header\"\n  }, __jsx(\"h2\", {\n    style: {\n      paddingTop: 30,\n      paddingLeft: 30\n    },\n    className: \"jsx-1470127334\"\n  }, \"Log In\")), __jsx(\"section\", {\n    className: \"jsx-1470127334\" + \" \" + \"wrapper\"\n  }, Object.entries(error).length !== 0 && error.constructor === Object && error.message.map(function (error) {\n    return __jsx(\"div\", {\n      key: error.messages[0].id,\n      style: {\n        marginBottom: 10\n      },\n      className: \"jsx-1470127334\"\n    }, __jsx(\"small\", {\n      style: {\n        color: \"red\"\n      },\n      className: \"jsx-1470127334\"\n    }, error.messages[0].message));\n  }), showForm ? __jsx(Form, null, __jsx(\"fieldset\", {\n    disabled: loading,\n    className: \"jsx-1470127334\"\n  }, __jsx(FormGroup, null, __jsx(Label, null, \"Email:\"), __jsx(Input // onChange={(event) => onChange(event)}\n  , {\n    onChange: function onChange(event) {\n      setLoginEmail(event.target.value);\n    },\n    name: \"identifier\",\n    style: {\n      height: 50,\n      fontSize: \"1.2em\"\n    }\n  })), __jsx(FormGroup, {\n    style: {\n      marginBottom: 30\n    }\n  }, __jsx(Label, null, \"Password:\"), __jsx(Input // onChange={(event) => onChange(event)}\n  , {\n    onChange: function onChange(event) {\n      setLoginPassword(event.target.value);\n    },\n    type: \"password\",\n    name: \"password\",\n    style: {\n      height: 50,\n      fontSize: \"1.2em\"\n    }\n  })), __jsx(FormGroup, null, __jsx(Button, {\n    style: {\n      \"float\": \"right\",\n      width: 120\n    },\n    color: \"primary\",\n    onClick: authenticate // onClick={() => {\n    //   setLoading(true);\n    //   login(data.identifier, data.password)\n    //     .then((res) => {\n    //       setLoading(false);\n    //       console.log(\"In login Button. res.data.user: \");\n    //       console.log(res.data.user);\n    //       // set authed User in global context to update header/app state\n    //       appContext.setUser(res.data.user);\n    //     })\n    //     .catch((error) => {\n    //       console.log(\n    //         \"login fun catch block, something is wrong: \"\n    //       );\n    //       console.log(error);\n    //       //setError(error.response.data);\n    //       setLoading(false);\n    //     });\n    // }}\n\n  }, loading ? \"Loading... \" : \"Submit\")))) : __jsx(\"div\", {\n    className: \"jsx-1470127334\"\n  }, __jsx(\"h4\", {\n    className: \"jsx-1470127334\"\n  }, \"Thank you for logging in! \"), __jsx(\"h5\", {\n    className: \"jsx-1470127334\"\n  }, \"You are now signed in as \", loginEmail), __jsx(Button // style={{ float: \"right\", width: 120 }}\n  , {\n    color: \"primary\",\n    onClick: logout\n  }, \"Log Out\")), errorMsg && __jsx(\"h4\", {\n    className: \"jsx-1470127334\"\n  }, errorMsg))))), __jsx(_JSXStyle, {\n    id: \"1470127334\"\n  }, [\".paper.jsx-1470127334{border:1px solid lightgray;box-shadow:0px 1px 3px 0px rgba(0,0,0,0.2), 0px 1px 1px 0px rgba(0,0,0,0.14), 0px 2px 1px -1px rgba(0,0,0,0.12);border-radius:6px;margin-top:90px;}\", \".notification.jsx-1470127334{color:#ab003c;}\", \".header.jsx-1470127334{width:100%;height:120px;background-color:#2196f3;margin-bottom:30px;border-radius-top:6px;}\", \".wrapper.jsx-1470127334{padding:10px 30px 20px 30px !important;}\", \"a.jsx-1470127334{color:blue !important;}\", \"img.jsx-1470127334{margin:15px 30px 10px 50px;}\"]));\n}\n\nexport default Login;","map":null,"metadata":{},"sourceType":"module"}